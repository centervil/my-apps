# Requirements: 認証ファイル保存パスの不整合修正

## 1. 概要 (Overview)
Spotify Automation における認証ファイル (`spotify-auth.json`) のパス指定が、現在相対パスに依存しており、実行ディレクトリの違いによって保存・読み込み場所の不整合が発生しています。本対応では、ホームディレクトリ (`$HOME`) を基準とした絶対パス方式に統一し、環境依存を排除します。

## 2. ユーザーストーリー (User Stories)

### Story 1: 認証ファイルのパス解決を一貫させる
- **As a** 開発者/CIシステム
- **I want to** どのディレクトリからスクリプトを実行しても、常に同じ場所にある認証ファイルを参照したい
- **So that** 手動実行やCI実行での認証エラーやファイルの二重管理を防ぐことができる

### Story 2: 環境変数によるパス指定
- **As a** CI管理者
- **I want to** 環境変数 `SPOTIFY_AUTH_PATH` を設定することで、認証ファイルの場所を任意に指定したい
- **So that** シークレット管理された認証ファイルを柔軟に利用できる

## 3. 受け入れ基準 (Acceptance Criteria)

- [ ] **共通パス解決ロジックの実装**
    - `src/utils/paths.ts` にパス解決ロジックが集約されていること。
    - 解決されたパスは常に絶対パスであること。

- [ ] **デフォルトパスの仕様**
    - 環境変数が未設定の場合、デフォルトで `$HOME/.my-apps/credentials/spotify-auth.json` が使用されること。
    - デフォルトパスを使用する際、ディレクトリが存在しない場合は自動的に作成されること。

- [ ] **環境変数の優先**
    - 環境変数 `SPOTIFY_AUTH_PATH` が設定されている場合、その値が最優先で使用されること。
    - 指定されたパスが相対パスの場合でも、適切に絶対パスに解決されること（または絶対パス指定を強制するドキュメント更新）。

- [ ] **既存機能の修正**
    - `scripts/saveAuth.ts` が新しいロジックを使用して認証ファイルを保存すること。
    - `src/features/spotifyUploader.ts` が新しいロジックを使用して認証ファイルを読み込むこと。
    - `tests/auth.setup.ts` (存在する場合) および `playwright.config.ts` も新しいロジックに適合していること。

- [ ] **テスト**
    - 認証ファイルのパス解決ロジックに対するユニットテストが作成され、パスしていること。
    - 既存のE2Eテスト（認証が必要なもの）がリグレッションなく動作すること。
