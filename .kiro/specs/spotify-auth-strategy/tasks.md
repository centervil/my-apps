# Implementation Plan

- [ ] 1. プロジェクト構造とセキュリティ基盤の設定
  - `.auth/` ディレクトリを作成し、`.gitignore` に認証ファイルを追加
  - 認証情報保存用のディレクトリ構造を確立
  - _Requirements: 1.2, 5.2_

- [ ] 2. 認証管理の中核機能を実装
- [ ] 2.1 AuthManager クラスの基本実装
  - 認証状態の保存・読み込み機能を持つ AuthManager クラスを作成
  - Cookie、localStorage、sessionStorage の管理機能を実装
  - _Requirements: 1.1, 2.1, 2.2_

- [ ] 2.2 認証状態データモデルの定義
  - AuthState インターフェースと関連する型定義を作成
  - 認証情報の構造化とバリデーション機能を実装
  - _Requirements: 1.2, 2.2_

- [ ] 2.3 認証情報保存スクリプトの作成
  - 手動ログイン後の認証情報を保存する scripts/saveAuth.ts を実装
  - ブラウザ自動化による認証状態キャプチャ機能を作成
  - _Requirements: 1.1, 1.3_

- [ ] 3. エラーハンドリングとバリデーション機能の実装
- [ ] 3.1 認証エラー処理クラスの作成
  - AuthError クラスと ErrorHandler クラスを実装
  - 認証ファイル関連、認証状態、ネットワークエラーの分類と処理
  - _Requirements: 1.3, 2.3, 2.4_

- [ ] 3.2 認証状態の検証機能
  - 認証ファイルの存在確認と有効性検証を実装
  - 期限切れ認証の検出と通知機能を作成
  - _Requirements: 2.4, 5.2_

- [ ] 4. Playwright テスト統合機能の実装
- [ ] 4.1 AuthSetup ユーティリティクラスの作成
  - テスト実行時の認証セットアップを自動化する AuthSetup クラスを実装
  - ブラウザコンテキストへの認証状態設定機能を作成
  - _Requirements: 2.1, 2.2_

- [ ] 4.2 Playwright 設定ファイルの更新
  - playwright.config.ts に認証状態の設定を追加
  - グローバルセットアップとプロジェクト設定を更新
  - _Requirements: 2.1, 3.3_

- [ ] 5. 既存テストファイルのリファクタリング
- [ ] 5.1 login.spec.ts の目的再定義
  - ログインテストから認証状態検証テストへ変更
  - 新しい認証戦略に基づくテスト内容に更新
  - _Requirements: 3.1, 4.1, 4.2_

- [ ] 5.2 newEpisode.spec.ts の認証方式更新
  - 事前認証された状態から開始するようにテストを修正
  - ログイン処理を削除し、認証済み前提での機能テストに変更
  - _Requirements: 3.2, 3.3_

- [ ] 6. テストスイートの作成と検証
- [ ] 6.1 AuthManager のユニットテストを作成
  - 認証情報の保存・読み込み機能のテストを実装
  - エラーハンドリングとバリデーション機能のテストを作成
  - _Requirements: 1.1, 1.3, 2.2_

- [ ] 6.2 統合テストの実装
  - 認証情報保存から読み込みまでの完全なフローをテスト
  - ブラウザコンテキストでの認証状態設定を検証
  - _Requirements: 2.1, 2.2, 3.3_

- [ ] 7. ドキュメントとガイドラインの整備
- [ ] 7.1 使用方法ドキュメントの作成
  - 新しい認証戦略の使用手順を README に追加
  - 認証情報保存スクリプトの実行方法を文書化
  - _Requirements: 5.3_

- [ ] 7.2 トラブルシューティングガイドの作成
  - 認証関連エラーの対処法をドキュメント化
  - よくある問題と解決方法をまとめたガイドを作成
  - _Requirements: 1.3, 2.3, 2.4_

- [ ] 8. 既存Issue影響の評価と計画
- [ ] 8.1 ブロックされたIssueの見直し
  - Issue #11 など既存のブロックされたIssueを評価
  - 新しい認証戦略に基づく実行可能性を判定
  - _Requirements: 4.3_

- [ ] 8.2 新しい前提に基づくIssue計画の策定
  - 既存Issueのクローズと新Issue作成の計画を立案
  - 新しい認証戦略を前提とした開発ロードマップを作成
  - _Requirements: 4.3, 5.1_
